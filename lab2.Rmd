---
title: "Data Lab 2"
---

In this lab you will apply what you learned in [Data Lab 1](lab1.html) to analyze the fast plant data generated by the class this semester.

Remember, the question you are trying to answer is:

<blockquote class="text-success">Does the number of trichomes on Fast Plants (<i>Brassica rapa</i>) plants vary between the F0 (parent) and F1 (offspring) generations.</blockquote>

The figures and results you produce in this **Data Lab 2** are <span class="text-danger">due by the end of your lab</span>. Upload a Word document to your lab (not lecture) D2L page under Assessment > Assignments > Data Lab 2.

This assignment will also form the RESULTS section of your **Fast Plant Lab Report**, which is <span class="text-warning">due Friday, November 16th</span>. The template for that report is available [here](sci_writing.html#fast-plant-lab-report-template).

## Your assignment

Your objective in this lab is to generate the results that will answer the question above, specifically by producing the following:

- A histogram showing how the distribution of numbers of trichomes varied between generations. It should also show which plants in the F0 generation were selected for breeding and which were not.
- A bar chart showing how the mean number of trichomes varied between generations. Include a 95% confidence interval around the means.
- Figure legends describing these two figures.
- A paragraph describing the results of the analysis, including the results of a *t*-test to test for a difference between the means.

To answer the question, you should:

1. Create a new RStudio project.
2. Download the Fast Plant data (see [Fast plant data] below).
2. Install the **tidyverse** package.
2. Copy the code from the [Data Lab 1 beak length script  &rarr;](lab1_beak_length_script.html) [click link] and paste it into a new script.
3. Modify the new script for use with the fast plant data `"fastplant_data.xlsx"`.
4. Plot a histogram with facets for each generation (F0 and F1), but instead of setting the fill color to vary by generation, set it to vary by whether or not the plants were selected for breeding. For help, see [A new variation] below.

For a reminder on how to perform the analysis and writing steps, see [Data Lab 1, Part 4. Bluestem Data Assignment &rarr;](lab1_4_bluestem.html).

When you are finished:

- Paste your figures into a Word document, add figure legends and a Results paragraph, and upload it to your *lab* D2L page under Assessments > Assignments > Data Lab 2.
- Save your project for later use by uploading the project folder onto OneDrive ([instructions](lab1_4_bluestem.html#saving-your-files)).

This assignment is <span class="text-danger">due by the end of your lab</span>.

Your Fast Plant Lab Report is <span class="text-warning">due Friday, November 16th</span>. See the [Scientific Writing](sci_writing.html#fast-plant-lab-report-template) page to download the lab report template.

### Fast plant data

You can download the fast plant data here:

<a href="fastplant_data.xlsx"><i class="fas fa-file-excel fa-5x"></i></a>

Each row in the dataset represents an individual plant.

The variables in the dataset are:

- **generation**. The generation the plant belonged to? (values include `"F0"` or `"F1"`)
- **trichome_count**. The number of trichomes the plant had. (values are numeric integers)
- **selected**. For the F0 generation, was the individual plant selected for breeding? (values include, `"yes"`, `"no"`, or `"NA"` if the plant was from the F1 generation)

### A new variation

In the finch and bluestem analyses, you created a histogram for each group and also colored the histograms differently for each group.

In theory, there is no reason you can't use a different variable to color the histograms.

For example, here is the finch data colored by `sex`:

```{r read-finch-data, echo=FALSE, message=FALSE, warning=FALSE, results='hide'}
source("beak_length.R")
file.remove("Beak Length Histogram.png")
file.remove("Beak Length Bar Chart.png")
```

```{r finch-sex-histogram, fig.width=6, fig.height=3.5, fig.align='center'}
# histogram of beak length, grouped by survival, colored by sex
ggplot(
  data = finches,
  mapping = aes(x = beak_length,
                fill = sex)           # color the boxes by gender
) +
  geom_histogram(bins = 14) +
  facet_wrap(~ outcome, ncol = 1) +   # put each outcome in its own panel
  labs(
    title = "Distribution of beak lengths",
    subtitle = "Grouped by bird sex and survival outcome",
    x = "Beak Length (mm)",
    y = "Number of Birds"
  )
```

For **your** current assignment, put each generation of plants on its own panel, and set the fill color of the columns by whether the plants were **selected** for breeding or not.

Remove the line `guides(fill = FALSE) +` to show the fill color legend.

In *your* figures, do not use subtitles and set your titles to say `"Figure 1."` and `"Figure 2."`.

For example:

```{r fast-plant-histogram, fig.width=6, fig.height=3.5, fig.align='center', echo=FALSE}
read_excel("fastplant_data.xlsx") %>% 
  ggplot(aes(trichome_count)) +
  geom_histogram(aes(fill = selected), bins = 12) +
  facet_wrap(~ generation, ncol = 1) +
  scale_fill_discrete(
    name = "Selected for\nbreeding?",
    breaks = c("no", "yes", "NA"),
    labels = c("No", "Yes", "F1")
  ) +
  labs(
    title = "Distribution of trichome counts",
    subtitle = "Grouped by generation and selection status",
    x = "Number of trichomes",
    y = "Number of plants"
  )
```



